<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no" />
  
  <!-- App Identity -->
  <title>Pick4U - איסוף חבילות קהילתי</title>
  <meta name="description" content="הפתרון החברתי לאיסוף חבילות ודואר - חבר בין מי שצריך לאסוף למי שיכול לעזור" />
  <meta name="author" content="Pick4U Team" />
  <meta name="keywords" content="איסוף חבילות, דואר, קהילה, משלוחים, Pick4U" />
  
  <!-- App Icons -->
  <link rel="icon" href="/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/icons/icon-32x32.png" sizes="32x32" type="image/png">
  <link rel="icon" href="/icons/icon-16x16.png" sizes="16x16" type="image/png">
  
  <!-- Apple Touch Icons -->
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png">
  
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Pick4U">
  
  <!-- iOS Splash Screens -->
  <link rel="apple-touch-startup-image" href="/splash/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/splash/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/splash/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/splash/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/splash/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/splash/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/splash/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/splash/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  
  <!-- Android Chrome -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#3B82F6">
  <meta name="msapplication-navbutton-color" content="#3B82F6">
  <meta name="msapplication-TileColor" content="#3B82F6">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Pick4U - איסוף חבילות קהילתי" />
  <meta property="og:description" content="הפתרון החברתי לאיסוף חבילות ודואר - חבר בין מי שצריך לאסוף למי שיכול לעזור" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://pick4u.app" />
  <meta property="og:image" content="/icons/og-image.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:locale" content="he_IL" />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Pick4U - איסוף חבילות קהילתי">
  <meta name="twitter:description" content="הפתרון החברתי לאיסוף חבילות ודואר">
  <meta name="twitter:image" content="/icons/twitter-image.png">
  
  <!-- Preload Critical Resources -->
  <link rel="preload" href="/fonts/inter-var.woff2" as="font" type="font/woff2" crossorigin>
  
  <!-- Security -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">
  
  <!-- Performance -->
  <meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width">
  
  <style>
    /* Critical CSS for loading screen */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #3B82F6 0%, #6366F1 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      color: white;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .loading-logo {
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
      animation: pulse 2s ease-in-out infinite;
    }
    
    .loading-text {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 8px;
    }
    
    .loading-subtitle {
      font-size: 14px;
      opacity: 0.8;
      margin-bottom: 32px;
    }
    
    .loading-spinner {
      width: 32px;
      height: 32px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top: 3px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Hide loading screen when app loads */
    .app-loaded #loading-screen {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease-out;
    }
  </style>
</head>

<body>
  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="loading-logo">
      📦
    </div>
    <div class="loading-text">Pick4U</div>
    <div class="loading-subtitle">טוען את האפליקציה...</div>
    <div class="loading-spinner"></div>
  </div>
  
  <!-- App Root -->
  <div id="root"></div>
  
  <!-- Service Worker Registration -->
  <script>
    // Register service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('SW registered: ', registration);
            
            // Check for updates
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // New content available, show update notification
                  if (confirm('גרסה חדשה זמינה! האם לעדכן עכשיו?')) {
                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                    window.location.reload();
                  }
                }
              });
            });
          })
          .catch(error => {
            console.log('SW registration failed: ', error);
          });
      });
      
      // Handle service worker updates
      navigator.serviceWorker.addEventListener('controllerchange', () => {
        window.location.reload();
      });
    }
    
    // Hide loading screen when app loads
    window.addEventListener('load', () => {
      setTimeout(() => {
        document.body.classList.add('app-loaded');
      }, 1000);
    });
    
    // Install prompt for PWA
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      // Show install button after 3 seconds
      setTimeout(() => {
        if (deferredPrompt && !window.matchMedia('(display-mode: standalone)').matches) {
          const installBanner = document.createElement('div');
          installBanner.innerHTML = `
            <div style="position: fixed; bottom: 20px; left: 20px; right: 20px; background: #3B82F6; color: white; padding: 16px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 1000; display: flex; align-items: center; justify-content: space-between; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
              <div>
                <div style="font-weight: bold; margin-bottom: 4px;">התקן את Pick4U</div>
                <div style="font-size: 14px; opacity: 0.9;">קבל גישה מהירה לאפליקציה</div>
              </div>
              <div>
                <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 8px 12px; border-radius: 8px; margin-left: 8px; cursor: pointer;">לא תודה</button>
                <button onclick="installApp()" style="background: white; border: none; color: #3B82F6; padding: 8px 16px; border-radius: 8px; font-weight: bold; cursor: pointer;">התקן</button>
              </div>
            </div>
          `;
          document.body.appendChild(installBanner);
        }
      }, 3000);
    });
    
    // Install app function
    function installApp() {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((result) => {
          if (result.outcome === 'accepted') {
            console.log('User accepted the install prompt');
          }
          deferredPrompt = null;
        });
      }
    }
    
    // Track app install
    window.addEventListener('appinstalled', (evt) => {
      console.log('App was installed');
      // Hide install banner if visible
      const banner = document.querySelector('[style*="position: fixed"]');
      if (banner) banner.remove();
    });
  </script>
  
  <!-- App Script -->
  <script type="module" src="/src/main.tsx"></script>
</body>

</html>